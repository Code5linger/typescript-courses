{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/course/monorepos-v2/09-nx/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Learn TypeScript w/ Mike North","courses":[{"id":"monorepos-v2","name":"TypeScript Monorepos v2","summary":null},{"id":"domain-modeling-with-ts","name":"Domain modeling for humans and AI","summary":"Learn how to model a domain in TypeScript, and how to collaborate with domain experts and agentic AI coding tools to build a software system that solves real problems.\n"},{"id":"fundamentals-v3","name":"TypeScript Fundamentals v3","summary":"Learn everything you need to know in order to confidently and successfully use TypeScript to build a modern JavaScript app."},{"id":"fundamentals-v4","name":"TypeScript Fundamentals v4","summary":"Learn everything you need to know in order to confidently and successfully use TypeScript to build a modern JavaScript app."},{"id":"intermediate-v1","name":"Intermediate TypeScript v1","summary":"Leverage TypeScript's strengths to provide clarity in the face of\ncomplexity, while protecting your codebase and team from it's weaknesses.\n"},{"id":"intermediate-v2","name":"Intermediate TypeScript v2","summary":"Leverage TypeScript's strengths to provide clarity in the face of\ncomplexity, while protecting your codebase and team from it's weaknesses.\n"},{"id":"making-typescript-stick","name":"Making TypeScript Stick","summary":"Tackle a series of challenges designed to reinforce your knowledge and make\nthe important concepts truly \"stick\" in your mind.\n"},{"id":"enterprise-v2","name":"Enterprise-Scale TypeScript v2","summary":"Learn how to manage large TypeScript code bases with confidence and ease.\nIn this course, Mike shares his knowledge from years of experience working\nwith teams who maintain TypeScript projects with hundreds of regular full-time\ncontributors and 100K+ lines of code.\n"},{"id":"full-stack-typescript","name":"Full Stack TypeScript","summary":"Combine TypeScript and GraphQL's type systems to create full-stack, fully\ntype-checked code bases that are shockingly easy to refactor and maintain.\n"}]}},"markdownRemark":{"id":"d2989cb9-bb0e-5b63-8a8e-e1e94c11f146","excerpt":"Lerna is a monorepo tool that’s been around for a while. There was a period of time where it was basically abandoned, and it has since been maintained by the Nx…","html":"<p>Lerna is a monorepo tool that’s been around for a while. There was a period of time where it was basically abandoned, and <a href=\"https://dev.to/nrwl/lerna-is-dead-long-live-lerna-3jal\">it has since been maintained by the Nx team</a>. We’ll look at what Lerna can do for us, and then we’ll see when it’s appropriate to use Nx directly instead.</p>\n<h2 id=\"lerna\" style=\"position:relative;\"><a href=\"#lerna\" aria-label=\"lerna permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lerna</h2>\n<p>Run</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">sh</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">pnpm dlx lerna init</span></div></code></div></pre>\n<p>You should then be able to run</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">sh</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">pnpm lerna run build</span></div></code></div></pre>\n<p>Which will build every package in the monorepo. You can similarly run</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">sh</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">pnpm lerna run </span><span style=\"color: #0550AE\">test</span></div><div class='line'><span style=\"color: #24292F\">pnpm lerna run lint</span></div></code></div></pre>\n<p>You can run multiple tasks</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">sh</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">pnpm lerna run build,lint,test,check</span></div></code></div></pre>\n<p>You can stream output</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">sh</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">pnpm lerna run build,lint,test,check --stream</span></div></code></div></pre>\n<p>You can control the degree of parallelism</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">sh</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">pnpm lerna run build,lint,test,check --concurrency=2</span></div></code></div></pre>\n<p>Or unlimited concurrency</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">sh</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">pnpm lerna run build,lint,test,check --parallel</span></div></code></div></pre>\n<h2 id=\"--since\" style=\"position:relative;\"><a href=\"#--since\" aria-label=\"  since permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>—since</h2>\n<p>A lot of the task running can be accomplished with pnpm (although it’s a bit more convoluted),  however lerna is much more sophisticated. It can run tasks based on changes relative to a given git ref (e.g. a branch). </p>\n<p>Change the logging message in\n<code>packages/server/src/index.ts</code></p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">diff</div><div class='code-container'><code><div class='line'><span style=\"color: #82071E\">-\t\tconsole.log(`Server listening on port http://localhost:${cfg.port}`)</span></div><div class='line'><span style=\"color: #116329\">+\t\tconsole.log(`Listening on port http://localhost:${cfg.port}`)</span></div></code></div></pre>\n<p>Now run</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">sh</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">pnpm lerna run </span><span style=\"color: #0550AE\">test</span><span style=\"color: #24292F\"> --since=origin/steps-2</span></div></code></div></pre>\n<p>and you should see that only tests in the <code>@seeds/server</code> package are run. If you make a change within the <code>@seeds/model</code> package, you should see that tests in <em>all three packages</em> are run because of the dependency graph.</p>\n<p>Particularly if you’re thinking about git pre-commit hooks (e.g. if you’re using <a href=\"https://github.com/typicode/husky\">husky</a>), this is a great foundational feature that lets you operate on the <em>increment of code change</em> while taking the dependency graph within the monorepo into account.</p>\n<h2 id=\"nx\" style=\"position:relative;\"><a href=\"#nx\" aria-label=\"nx permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nx</h2>\n<p>Let’s go deeper and explore using <code>Nx</code> directly.</p>\n<p>Install nx globally</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">sh</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">npm add --global nx</span></div><div class='line'><span style=\"color: #6E7781\"># OR</span></div><div class='line'><span style=\"color: #24292F\">volta install nx</span></div></code></div></pre>\n<p>And install it in the root of the repo</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">sh</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">pnpm dlx nx init</span></div></code></div></pre>\n<p>Follow the prompts to create a <code>nx.json</code> file</p>\n<p>At the end of the process we should benefit from distributed caching. As long as the inputs to cachable build tasks are the same, the output should be the same and the response is pretty much instantaneous. This can dramatically speed up your build process.</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">sh</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">nx run-many -p models,ui,server,check -t build,lint,test</span></div></code></div></pre>","tableOfContents":"<ul>\n<li><a href=\"#lerna\">Lerna</a></li>\n<li><a href=\"#--since\">—since</a></li>\n<li><a href=\"#nx\">Nx</a></li>\n</ul>","fields":{"slug":"/course/monorepos-v2/09-nx/"},"frontmatter":{"title":"Nx","course":"monorepos-v2","date":"June 12, 2025","description":"We'll learn to use the nx monorepo tool for dependency-aware builds and distributed caching\n"}}},"pageContext":{"slug":"/course/monorepos-v2/09-nx/","title":"Nx","course":"monorepos-v2","date":"2025-06-12T09:00:00.000Z","previous":{"fields":{"slug":"/course/monorepos-v2/10-api-extractor/"},"frontmatter":{"title":"API Extractor","date":"2025-06-12T09:00:00.000Z","course":"monorepos-v2","isExercise":null}},"next":null}},
    "staticQueryHashes": ["2785745750","2841359383"]}