{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/course/monorepos-v2/03-hello-workspace/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Learn TypeScript w/ Mike North","courses":[{"id":"monorepos-v2","name":"TypeScript Monorepos v2","summary":null},{"id":"domain-modeling-with-ts","name":"Domain modeling for humans and AI","summary":"Learn how to model a domain in TypeScript, and how to collaborate with domain experts and agentic AI coding tools to build a software system that solves real problems.\n"},{"id":"fundamentals-v3","name":"TypeScript Fundamentals v3","summary":"Learn everything you need to know in order to confidently and successfully use TypeScript to build a modern JavaScript app."},{"id":"fundamentals-v4","name":"TypeScript Fundamentals v4","summary":"Learn everything you need to know in order to confidently and successfully use TypeScript to build a modern JavaScript app."},{"id":"intermediate-v1","name":"Intermediate TypeScript v1","summary":"Leverage TypeScript's strengths to provide clarity in the face of\ncomplexity, while protecting your codebase and team from it's weaknesses.\n"},{"id":"intermediate-v2","name":"Intermediate TypeScript v2","summary":"Leverage TypeScript's strengths to provide clarity in the face of\ncomplexity, while protecting your codebase and team from it's weaknesses.\n"},{"id":"making-typescript-stick","name":"Making TypeScript Stick","summary":"Tackle a series of challenges designed to reinforce your knowledge and make\nthe important concepts truly \"stick\" in your mind.\n"},{"id":"enterprise-v2","name":"Enterprise-Scale TypeScript v2","summary":"Learn how to manage large TypeScript code bases with confidence and ease.\nIn this course, Mike shares his knowledge from years of experience working\nwith teams who maintain TypeScript projects with hundreds of regular full-time\ncontributors and 100K+ lines of code.\n"},{"id":"full-stack-typescript","name":"Full Stack TypeScript","summary":"Combine TypeScript and GraphQL's type systems to create full-stack, fully\ntype-checked code bases that are shockingly easy to refactor and maintain.\n"}]}},"markdownRemark":{"id":"644470c2-a51b-54fe-bd5a-7e11aa352b36","excerpt":"What’s a workspace? A pnpm workspace is a monorepo setup driven by a root-level pnpm-workspace.yaml file that lists all local package folders. What do we want…","html":"<h2 id=\"whats-a-workspace\" style=\"position:relative;\"><a href=\"#whats-a-workspace\" aria-label=\"whats a workspace permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What’s a workspace?</h2>\n<p>A <strong>pnpm workspace</strong> is a monorepo setup driven by a root-level <code>pnpm-workspace.yaml</code> file that lists all local package folders.</p>\n<h3 id=\"what-do-we-want-to-see\" style=\"position:relative;\"><a href=\"#what-do-we-want-to-see\" aria-label=\"what do we want to see permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What do we want to see?</h3>\n<ul>\n<li><code>pnpm install</code> continues to work</li>\n<li><code>pnpm run { build, lint, test }</code> continue to work</li>\n<li>We haven’t ruined our <code>git</code> history</li>\n<li>We haven’t lost our lockfile package versions</li>\n<li>…more benefits to come later</li>\n</ul>\n<p><strong>We’re not looking to break the monolith up yet — that comes later</strong>. We’ll focus on making small incremental changes, and verify that things work early and often.</p>\n<h2 id=\"lets-go\" style=\"position:relative;\"><a href=\"#lets-go\" aria-label=\"lets go permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Let’s go!</h2>\n<p>Begin by creating a <code>packages/ui</code> folder</p>\n<h3 id=\"the-monolith-becomes-the-first-monorepo-package\" style=\"position:relative;\"><a href=\"#the-monolith-becomes-the-first-monorepo-package\" aria-label=\"the monolith becomes the first monorepo package permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The monolith becomes the first monorepo package</h3>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">sh</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">mkdir -p packages/ui</span></div></code></div></pre>\n<p>Move everything that was in the repo root folder into <code>packages/ui</code> <strong>except for the following files</strong></p>\n<ul>\n<li><code>.gitignore</code></li>\n<li><code>.nvpmrc</code></li>\n<li><code>.prettierrc</code></li>\n<li><code>pnpm-lock.yaml</code></li>\n<li><code>README.md</code></li>\n</ul>\n<p>Now create a top-level file in the repo called <code>pnpm-workspace.yaml</code>.</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">yaml</div><div class='code-container'><code><div class='line'><span style=\"color: #6E7781\"># pnpm-workspace.yaml</span></div><div class='line'><span style=\"color: #116329\">packages</span><span style=\"color: #24292F\">:</span></div><div class='line'><span style=\"color: #24292F\">  - </span><span style=\"color: #0A3069\">'packages/*'</span></div></code></div></pre>\n<p>You’ll need to create a <em>very thin</em> top-level <code>package.json</code> file</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">json</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">{</span></div><div class='line'><span style=\"color: #24292F\">  </span><span style=\"color: #0550AE\">\"name\"</span><span style=\"color: #24292F\">: </span><span style=\"color: #0A3069\">\"seeds\"</span><span style=\"color: #24292F\">,</span></div><div class='line'><span style=\"color: #24292F\">\t</span><span style=\"color: #0550AE\">\"repository\"</span><span style=\"color: #24292F\">: </span><span style=\"color: #0A3069\">\"https://github.com/mike-north/ts-monorepos-v2\"</span><span style=\"color: #24292F\">,</span></div><div class='line'><span style=\"color: #24292F\">  </span><span style=\"color: #0550AE\">\"private\"</span><span style=\"color: #24292F\">: </span><span style=\"color: #0550AE\">true</span><span style=\"color: #24292F\">,</span></div><div class='line'><span style=\"color: #24292F\">  </span><span style=\"color: #0550AE\">\"volta\"</span><span style=\"color: #24292F\">: {</span></div><div class='line'><span style=\"color: #24292F\">    </span><span style=\"color: #0550AE\">\"node\"</span><span style=\"color: #24292F\">: </span><span style=\"color: #0A3069\">\"22.16.0\"</span></div><div class='line'><span style=\"color: #24292F\">  }</span></div><div class='line'><span style=\"color: #24292F\">}</span></div></code></div></pre>\n<p>…and because “seeds” was the name of our monolith package, let’s change that to <code>@seeds/ui</code></p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">diff</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">{</span></div><div class='line'><span style=\"color: #116329\">+  \"name\": \"@seeds/ui\",</span></div><div class='line'><span style=\"color: #82071E\">-  \"name\": \"seeds\",</span></div><div class='line'><span style=\"color: #24292F\">  \"private\": true,</span></div><div class='line'><span style=\"color: #24292F\">  \"version\": \"0.0.0\",</span></div><div class='line'><span style=\"color: #24292F\">  \"type\": \"module\",</span></div><div class='line'><span style=\"color: #24292F\">  ...</span></div><div class='line'><span style=\"color: #24292F\">}</span></div></code></div></pre>\n<p>What we’re leaning into with this package naming convention is <a href=\"https://docs.npmjs.com/cli/v7/using-npm/scope\">npm scopes</a> — we could use <code>@seeds/*</code> for all of our monorepo packages, and potentially the workspace root as an “umbrella” package, so that those who already depend on it have a very clear upgrade path.</p>\n<p>Alternatively, we could have called the monorepo package something else like <code>seeds-workspace</code> and created <code>packages/seeds</code> with the <code>seeds</code> package. This might be a good choice if your existing users need CLI commands, and there’s more to maintaining general compatibility with users’ existing expecations of <code>seeds</code> than its existence in someone’s <code>package.json</code> file</p>\n<p>Now run </p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">sh</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">pnpm i</span></div></code></div></pre>\n<p>And it should complete successfully</p>\n<p>Next, let’s get those build, lint and test commands working</p>\n<p>In your root <code>package.json</code> add the following</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">json</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">{</span></div><div class='line'><span style=\"color: #24292F\">  </span><span style=\"color: #0550AE\">\"scripts\"</span><span style=\"color: #24292F\">: {</span></div><div class='line'><span style=\"color: #24292F\">    </span><span style=\"color: #0550AE\">\"build\"</span><span style=\"color: #24292F\">: </span><span style=\"color: #0A3069\">\"pnpm --color run -r build\"</span><span style=\"color: #24292F\">,</span></div><div class='line'><span style=\"color: #24292F\">    </span><span style=\"color: #0550AE\">\"lint\"</span><span style=\"color: #24292F\">: </span><span style=\"color: #0A3069\">\"pnpm --color run -r lint\"</span><span style=\"color: #24292F\">,</span></div><div class='line'><span style=\"color: #24292F\">    </span><span style=\"color: #0550AE\">\"check\"</span><span style=\"color: #24292F\">: </span><span style=\"color: #0A3069\">\"pnpm --color run -r check\"</span><span style=\"color: #24292F\">,</span></div><div class='line'><span style=\"color: #24292F\">    </span><span style=\"color: #0550AE\">\"test\"</span><span style=\"color: #24292F\">: </span><span style=\"color: #0A3069\">\"pnpm --color run -r test\"</span><span style=\"color: #24292F\">,</span></div><div class='line'><span style=\"color: #24292F\">    </span><span style=\"color: #0550AE\">\"format\"</span><span style=\"color: #24292F\">: </span><span style=\"color: #0A3069\">\"pnpm --color run -r format\"</span><span style=\"color: #24292F\">,</span></div><div class='line'><span style=\"color: #24292F\">    </span><span style=\"color: #0550AE\">\"dev\"</span><span style=\"color: #24292F\">: </span><span style=\"color: #0A3069\">\"pnpm --color run -r dev\"</span></div><div class='line'><span style=\"color: #24292F\">  },</span></div><div class='line'><span style=\"color: #24292F\">\t</span><span style=\"color: #0550AE\">\"volta\"</span><span style=\"color: #24292F\">: {</span></div><div class='line'><span style=\"color: #24292F\">\t\t</span><span style=\"color: #0550AE\">\"node\"</span><span style=\"color: #24292F\">: </span><span style=\"color: #0A3069\">\"22.16.0\"</span></div><div class='line'><span style=\"color: #24292F\">\t}</span></div><div class='line'><span style=\"color: #24292F\">}</span></div></code></div></pre>\n<p>Ok, let’s stage all the files we have changed</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">sh</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">git add -A </span><span style=\"color: #0550AE\">.</span></div></code></div></pre>\n<p>and run <code>git status</code></p>\n<p>Look at all those</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class='code-container'><code><div class='line'><span style=\"color: undefined\">renamed:  &lt;file&gt;</span></div><div class='line'><span style=\"color: undefined\">renamed:  &lt;file&gt;</span></div><div class='line'><span style=\"color: undefined\">renamed:  &lt;file&gt;</span></div><div class='line'><span style=\"color: undefined\">renamed:  &lt;file&gt;</span></div><div class='line'><span style=\"color: undefined\">renamed:  &lt;file&gt;</span></div></code></div></pre>\n<p>This means we’re preserving our git history. What you don’t want to see is files deleted and new files re-created. </p>\n<p>Check out our lockfile too</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">sh</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">git diff HEAD pnpm-lock.yaml</span></div></code></div></pre>\n<p>You should see</p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">diff</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">index a499dd8..9b6f4be 100644</span></div><div class='line'><span style=\"color: #82071E\">--- a/pnpm-lock.yaml</span></div><div class='line'><span style=\"color: #116329\">+++ b/pnpm-lock.yaml</span></div><div class='line'><span style=\"color: #8250DF\">@@ -6,7 +6,9 @@</span><span style=\"color: #24292F\"> settings:</span></div><div class='line'><span style=\"color: #24292F\"> </span></div><div class='line'><span style=\"color: #24292F\"> importers:</span></div><div class='line'><span style=\"color: #24292F\"> </span></div><div class='line'><span style=\"color: #82071E\">-  .:</span></div><div class='line'><span style=\"color: #116329\">+  .: {}</span></div><div class='line'><span style=\"color: #116329\">+</span></div><div class='line'><span style=\"color: #116329\">+  packages/ui:</span></div><div class='line'><span style=\"color: #24292F\">     dependencies:</span></div><div class='line'><span style=\"color: #24292F\">       cors:</span></div><div class='line'><span style=\"color: #24292F\">         specifier: ^2.8.5</span></div></code></div></pre>\n<p>This should give you confidence that we’re not releasing all of our locked versions as part of this process. </p>\n<p>At this point you should be able to run </p>\n<pre class=\"shiki github-light\" style=\"background-color: #ffffff; color: #24292f\"><div class=\"language-id\">sh</div><div class='code-container'><code><div class='line'><span style=\"color: #24292F\">pnpm build </span><span style=\"color: #CF222E\">&&</span><span style=\"color: #24292F\"> \\</span></div><div class='line'><span style=\"color: #24292F\">pnpm </span><span style=\"color: #0550AE\">test</span><span style=\"color: #24292F\"> </span><span style=\"color: #CF222E\">&&</span><span style=\"color: #24292F\"> \\</span></div><div class='line'><span style=\"color: #24292F\">pnpm lint </span><span style=\"color: #CF222E\">&&</span><span style=\"color: #24292F\"> \\</span></div><div class='line'><span style=\"color: #24292F\">pnpm check </span><span style=\"color: #CF222E\">&&</span><span style=\"color: #24292F\"> \\</span></div><div class='line'><span style=\"color: #24292F\">pnpm format</span></div></code></div></pre>\n<p>and see that everything works.</p>\n<p>Make a git commit, and let’s move on!</p>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#whats-a-workspace\">What’s a workspace?</a></p>\n<ul>\n<li><a href=\"#what-do-we-want-to-see\">What do we want to see?</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#lets-go\">Let’s go!</a></p>\n<ul>\n<li><a href=\"#the-monolith-becomes-the-first-monorepo-package\">The monolith becomes the first monorepo package</a></li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/course/monorepos-v2/03-hello-workspace/"},"frontmatter":{"title":"Hello, Workspace!","course":"monorepos-v2","date":"June 12, 2025","description":"We'll take the smallest set of possible steps to converting our project to a pnpm workspace\n"}}},"pageContext":{"slug":"/course/monorepos-v2/03-hello-workspace/","title":"Hello, Workspace!","course":"monorepos-v2","date":"2025-06-12T09:00:00.000Z","previous":{"fields":{"slug":"/course/monorepos-v2/02-project-tour/"},"frontmatter":{"title":"Project tour","date":"2025-06-12T09:00:00.000Z","course":"monorepos-v2","isExercise":null}},"next":{"fields":{"slug":"/course/monorepos-v2/04-extracting-models/"},"frontmatter":{"title":"Extracting Models","date":"2025-06-12T09:00:00.000Z","course":"monorepos-v2","isExercise":null}}}},
    "staticQueryHashes": ["2785745750","2841359383"]}